{% extends "webapp/base_app.html" %}
{% block title %}Sesiones{% endblock %}
{% block content %}
<div class="mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Sesiones - {{ mes_actual|date:"F Y" }}</h2>
    <a class="btn btn-outline-primary" href="{% url 'webapp:sesion_rapida' %}">
      <i class="bi bi-calendar-plus"></i><span class="d-none d-md-inline ms-1">Nueva sesion</span>
    </a>
  </div>
  <form class="row g-2 mb-3" method="get">
    <div class="col-md-3">
      <label class="form-label">AÃ±o</label>
      <select name="year" class="form-select" onchange="this.form.submit()">
        {% for y in years %}
          <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <label class="form-label">Mes</label>
      <select name="month" class="form-select" onchange="this.form.submit()">
        {% for m in months %}
          <option value="{{ m }}" {% if m == month %}selected{% endif %}>{{ m }}</option>
        {% endfor %}
      </select>
    </div>
  </form>
  <div class="table-responsive">
    <table class="table table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th>Lunes</th>
          <th>Martes</th>
          <th>Miercoles</th>
          <th>Jueves</th>
          <th>Viernes</th>
          <th>Sabado</th>
          <th>Domingo</th>
        </tr>
      </thead>
      <tbody>
        {% for semana in semanas %}
        <tr style="height: 140px;">
          {% for dia in semana %}
          <td class="position-relative {% if not dia.en_mes %}bg-light text-muted{% endif %}">
            <div class="position-absolute top-0 start-0 m-2 fw-bold fs-6">{{ dia.fecha|date:"d" }}</div>
            <div class="pt-4">
            {% for sesion in dia.sesiones %}
              <div class="mb-2">
                <a class="badge text-bg-primary text-decoration-none" href="{% url 'webapp:sesion_detail' sesion.pk %}">{{ sesion.disciplina }}</a>
              </div>
            {% empty %}
              <div class="text-muted small">Sin sesiones</div>
            {% endfor %}
            </div>
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
